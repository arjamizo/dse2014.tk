<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
	<title>DSE14 - Distributed Systems Engineering at TUD (Technische Universitaet Dresden) 2014</title>
	<script src="http://www.polymer-project.org/platform.js"></script>
	<link rel="import" href="http://www.polymer-project.org/components/polymer/polymer.html">
	<link rel="import" href="http://www.polymer-project.org/components/core-localstorage/core-localstorage.html">
	<link rel="import" href="http://www.polymer-project.org/components/paper-tabs/paper-tabs.html">
	<link href="http://www.polymer-project.org/components/core-icons/core-icons.html" rel="import">
	<link href="http://www.polymer-project.org/components/paper-item/paper-item.html" rel="import">
	<link rel="import" href="http://www.polymer-project.org/components/paper-menu-button/paper-menu-button.html">
	<link type="text/css" rel="stylesheet" href="css/simplelittle.css" />
	<link rel="import" href="http://www.polymer-project.org/components/paper-checkbox/paper-checkbox.html">
	<link rel="import" href="http://www.polymer-project.org/components/paper-fab/paper-fab.html">
	<link rel="import" href="http://www.polymer-project.org/components/core-icons/core-icons.html">
	<link rel="import" href="http://www.polymer-project.org/components/paper-icon-button/paper-icon-button.html">
	<link rel="import" href="http://www.polymer-project.org/components/paper-input/paper-input.html">

</head>
<body>

	<div style="width: 100px;">
		You are going to be redirected to <a href="https://www.facebook.com/groups/358462094314942">Facebook DSE2014</a> in <span class="counter">30</span> seconds
		if you will not click anywhere on this webpage.
		<script>
		(function() {
			var intId=setInterval(function() { 
				var left=document.querySelector('span').textContent*1;
				return function() {
					document.querySelector('span').textContent = left--;
					if(left<0) window.location.href=document.querySelector('a').href;
				}
			}.call(), 1000);
			var hnd;
			hnd = document.addEventListener('click', function() {
				clearInterval(intId);
				document.body.removeChild(document.querySelector('div'));
				document.removeEventListener('click', hnd)
			})
		})();;
		</script>
	</div>

	<polymer-element name="tabs-with-content">
		<template>
			<style type="text/css">
				section {
					position: absolute !important;
					top: -9999px !important;
					left: -9999px !important;
				}
				section.core-selected {
					position: static !important;
					top: 0px !important;
					left: 0px !important;
				}
			</style>
			<core-localstorage name="selectedTab" value="{{selected}}"></core-localstorage>
			<div horizontal layout>
				<div>
					<dse-menu icon="menu">
						<a href="https://www.facebook.com/groups/358462094314942/">Go to Facebook Group</a>
					</dse-menu>
				</div>
				<div flex>
					<paper-tabs selected="{{selected}}">
						<paper-tab>Useful informations</paper-tab>
						<paper-tab>Schedule (Google Calendar)</paper-tab>
						<paper-tab>DVB for Studentenheim</paper-tab>
						<paper-tab>Contact</paper-tab>
					</paper-tabs>
				</div>
			</div>
			<core-selector selected="{{selected}}" flex layout vertical>
				<section flex layout vertical>
					<dse-useful>
						<dse-useful-tip text="You can access your mail at https://msx.tu-dresden.de"></dse-useful-tip>
						<dse-useful-tip text="Eclipse is not only an astronomical phenomena, but also an IDE and even framework"></dse-useful-tip>
						<dse-useful-tip text="There is old DSE-wiki available at http://web.archive.org/web/20130420191917/https://wiki.ifsr.de/ce/index.php?title=Main_Page"></dse-useful-tip>
						<dse-useful-tip text="[DPF] Did you read A. Tesanovic. What is a pattern? Paper in Design Pattern seminar, IDA, 2001?"></dse-useful-tip>
						<dse-useful-tip text="[DPF] Did you read Brad Appleton. Patterns and Software: Essential Concepts and terminology. http://www.sci.brooklyn.cuny.edu/~sklar/teaching/s08/cis20.2/papers/appleton-patterns-intro.pdf?"></dse-useful-tip>
						<dse-useful-tip text="[DPF] Did you read K. Beck, J. Coplien, R. Crocker, L. Dominick, G. Meszaros, F.Paulisch, J. Vlissides. Industrial Experience with Design Patterns. Int. Conference on Software Engineering (ICSE) 1996. http://dl.acm.org/citation.cfm?id=227747"></dse-useful-tip>
						<dse-useful-tip text="[DPF] Did you read everything else at http://st.inf.tu-dresden.de/files/teaching/ws14/dpf/00-announcements.pdf (also at http://www-st.inf.tu-dresden.de/Lehre/WS04-05/dpf/lit.html)?"></dse-useful-tip>
					</dse-useful>
				</section>
				<section flex layout vertical>
					<div>
						<p>This is calendar created from the schedule available at http://inf.tu-dresden.de. Remember that you can add this to your own calendar with bottom <italic>(+) calendar</italic>.</p>
						<iframe src="https://www.google.com/calendar/embed?mode=AGENDA&amp;height=600&amp;wkst=1&amp;bgcolor=%23FFFFFF&amp;src=ue22r3b7iqtk41f373mg707f0k%40group.calendar.google.com&amp;color=%23125A12&amp;ctz=Europe%2FBerlin" style=" border-width:0 " width="800" height="600" frameborder="0" scrolling="no"></iframe>
					</div>
				</section>
				<section>
					<p>This webpage shows you several offers from public transport, especially students living in Zellescher Weg or Wundtstrasse might find them very useful.</p>
					<dse-dvb from="Zelleschner" to="Technische" header="Studentheim to TUD (Bus 61)"></dse-dvb>
					<dse-dvb from="Technische" to="Zelleschner" header="TUD to Studentheim (Bus 61)"></dse-dvb>
					<dse-dvb from="Heinrich-Zille-Strasse" to="Helmholtzstrasse" header="Studentheim to TUD (INF) (Bus 85)"></dse-dvb>
					<dse-dvb from="Helmholtzstrasse" to="Heinrich-Zille-Strasse" header="TUD (INF) to Studentheim (Bus 85)"></dse-dvb>
				</section>
				<section>
					<p>Contact me at arjamizo at gmail dot com.</p>
					<p>If you want to contribute, go to <a href="https://github.com/arjamizo/dse2014.tk"><img height="20" alt="Github" src="https://assets-cdn.github.com/images/modules/logos_page/GitHub-Logo.png"/></a>.</p>
				</section>
			</core-selector>
		</template>
	</polymer-element>

	<tabs-with-content vertical layout flex></tabs-with-content>

	<script>
		Polymer("tabs-with-content", {
			selected: 0,
			ready: function() {
			},
			attached: function() {
			},
			selectedChanged: function() {
			},
		});

	</script>

	<polymer-element name="dse-menu" extends="paper-menu-button">
		<template>
			<shadow></shadow>
		</template>
		<script>
			Polymer({
				focusAction: function(e) {
				}
			});
		</script>
	</polymer-element>

	<polymer-element name="dse-useful">
		<template>
			<link type="text/css" rel="stylesheet" href="css/simplelittle.css" />
			<table>
				<tbody>
					<core-localstorage name="understood" value="{{understood}}"></core-localstorage>
					<template repeat="{{entry, id in entries}}">
						<tr>
							<td>{{entry}}</td>
							<td>
								<paper-checkbox class="blue" checked="{{understood[id]}}"></paper-checkbox>
								<span style="display: none;">{{understood[id]?1:0}}</span>
							</td>
						</tr>
					</template>
				</tbody>
			</table>
		</template>
		<script>
			Polymer({
				entries: [],
				understood: []
			});
		</script>
	</polymer-element>
	<polymer-element name="dse-useful-tip" attributes="text">
		<template>
		</template>
		<script>
			Polymer({
				domReady: function() {
					// this.async(function() {
						this.parentNode.entries.push(this.text);
					// })
				}
			})
		</script>
	</polymer-element>

	<polymer-element name="dse-dvb" attributes="from to header">
		<template>
			<link type="text/css" rel="stylesheet" href="css/simplelittle.css" />
			<style>
				:host {
					float: left;
					position: block;
				}
			</style>
			<paper-input on-change="{{refresh}}" value="{{overrideTime}}" placeholder="Custom trip time, e.g. 9:00"></paper-input>
			<h1>{{header}}
				<paper-icon-button on-tap="{{refresh}}" icon="refresh"></paper-icon-button>
			</h1>
			<a href="{{sourceurl}}" target="{{target}}">Source</a> (open link in new window 
			<paper-checkbox on-change='{{update}}'></paper-checkbox>)
			<table>
				<tbody>
					<template repeat = "{{trip in trips}}">
						<tr><td>{{trip[0]}}</td> <td>{{trip[1]}}</td><td>{{trip[2]}}</td></tr>
					</template>
				</tbody>
			</table>
		</template>
		<script>
			var cnt = 0;
			Polymer({
				overrideTime: '',
				sourceurl: '',
				target: '',
				update: function() {
					this.target = this.target!="_blank" ? "_blank" : "_self"
					console.log(this.target)
				},
				attached: function() {this.refresh();},
				refresh: function() {
					var params = {
						'vaform[datum]': function() { return [new Date().getDate(), new Date().getMonth() + 1, new Date().getFullYear()].join('.')},
						'vaform[startname]': function() {return this.from;}.bind(this),
						'vaform[startort]': 'Dresden',
						'vaform[starttype]': 'stop',
						'vaform[zeit]': function() {return (this.overrideTime && this.overrideTime.length>0 && this.overrideTime) || (new Date().getHours() + ":" + new Date().getMinutes());}.bind(this),
						'vaform[zeittyp]': 'dep',
						'vaform[zielname]': function() {return this.to;}.bind(this),
						'vaform[zielort]': 'Dresden',
						'vaform[zieltype]': 'stop',
					};
					params = Object.keys(params).map(function(i, e){ return i+"="+(typeof params[i]==='function'?params[i]():params[i]); }).join(escape('&'))
					console.log(params)

					var form = "http://www.dvb.de/en/Timetable/Journey-planner/direkt.do"

					console.log(form+"?"+params)
					var url="http://query.yahooapis.com/v1/public/yql?format=json&callback=_"+(++cnt)+"&q=select * from html where url = '" + (this.sourceurl = form + "?" + params) + "'";
					this.sourceurl = this.sourceurl.replace(/%26/g, '&')
					url += " and xpath='//*[@id=\"pdf_form\"]//*[@class=\"full trip\"]'";

					var handleJSONP = (function(cnt) {return function () {
						this.res = arguments[0].query.results;

						this.trips = this.res.table.map(function(e, i){
							var el=e.tbody.tr[0].td;
							if(JSON.stringify(el[4]).match('on foot')) return false;
							return [(el[0] && el[0].strong) || '', el[4] && el[4].strong || '', el[4] && el[4].p || '']
						})
						.filter(function(e) {return !!e;})

						this.text = JSON.stringify(this.res, null, 2);
						delete window['_'+cnt]
					}})(cnt).bind(this)

					window['_'+cnt]=handleJSONP;

					document.body.appendChild((function(url) {
						var el = document.createElement('script');
						el.type="text/javascript";
						el.src=url;
						return el;
					})(url));
				}
			});
		</script>
	</polymer-element>

</body>
</html>